#!/usr/bin/env python
# coding: utf-8

# # –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:
# 
# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è –µ—â–µ —Ä–∞–∑!) –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–æ–µ–∫—Ç!
# 
# –ú–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç —Ç–∞–∫–∂–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏, –Ω–æ —Å –ø–æ–º–µ—Ç–∫–æ–π 2:
#     
#     ¬´–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2: ... ¬ª

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
# –ï–≤–≥–µ–Ω–∏–π, —Ç—ã —Ö–æ—Ä–æ—à–æ –¥–æ—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–æ–µ–∫—Ç, –Ω–æ —è –Ω–µ—Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏—Ö –∏–∑—É—á–∏, –ø–ª—é—Å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—Ä–æ–≤–∞–ª –Ω–µ–Ω—É–∂–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã.
# 
# –ï—â–µ —Ä–∞–∑ –æ—Ç–º–µ—á—É:
#     
# * –∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ \ —Ñ–∞–π–ª–æ–≤ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤ –Ω–∞—á–∞–ª–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ (–æ–¥–Ω–∏–º —Å–∫–æ–ø–æ–º —Ç–∞–∫ —Å–∫–∞–∑–∞—Ç—å). –ö–æ–¥ –≤ Jupyter –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, —Ç.–µ. —Ç–≤–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∞–π–ª–∞ borrowers –º–æ–≥–ª–æ –±—ã—Ç—å –ø–æ –ø—Ä–∏—á–∏–Ω–µ —Ç–æ–≥–æ, —á—Ç–æ —Ç—ã –≥–¥–µ-—Ç–æ –≤—ã—à–µ –ø—Ä–æ—Å—Ç–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª –µ–≥–æ –∏–º–ø–æ—Ä—Ç, –≤–æ—Ç –∏ –≤—Å–µ. –î–∞–Ω–Ω—ã–π –Ω–µ–¥—É–≥ –ª–µ—á–∏—Ç—Å—è –ø—É—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —è—á–µ–µ–∫ –∫–æ–¥–∞ –≤—ã—à–µ, —Ç.–µ. —Ç—ã –≤—Å—Ç–∞–µ—à—å –Ω–∞ –∫–∞–∫—É—é –ª–∏–±–æ —è—á–µ–π–∫–µ –≤ –Ω–æ—Ç–±—É–∫–µ –∏ –Ω–∞ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã—à–µ –≤—ã–±–∏—Ä–∞–µ—à—å `cell - > run all above`, —Ç–µ–º —Å–∞–º—ã–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–µ—Å—å –∫–æ–¥ –≤—ã—à–µ
# 
# 
# </div>

# # –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê
# –ü—Ä–∏–≤–µ—Ç, –ï–≤–≥–µ–Ω–∏–πüëã!)
# 
# –ú–µ–Ω—è –∑–æ–≤—É—Ç –û–±–∏–¥–∏–Ω –ê–Ω–¥—Ä–µ–π, —è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–æ–µ–∫—Ç–∞. –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–π–¥–µ–º —Å—Ä–∞–∑—É –Ω–∞ <b>—Ç—ã</b>? –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–æ, —Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–∞–π –∑–Ω–∞—Ç—å)
# 
# –ë–ª–∞–≥–æ–¥–∞—Ä—é —Ç–µ–±—è –∑–∞ —Ç–æ, —á—Ç–æ –≤–æ–≤—Ä–µ–º—è –≤—Å—ë —Å–¥–∞–ª –∏ —Ö–æ—Ä–æ—à–æ –ø–æ—Ä–∞–±–æ—Ç–∞–ª!)
# 
# `–£ —Ç–µ–±—è –ø–æ–ª—É—á–∏–ª—Å—è —Ö–æ—Ä–æ—à–∏–π –ø—Ä–æ–µ–∫—Ç, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–º–µ–Ω—Ç—ã –Ω—É–∂–Ω–æ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å. –Ø –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã, –æ–Ω–∏ —Ç–µ–±–µ –ø–æ–º–æ–≥—É—Ç. –û–¥–Ω–∞–∫–æ —Ö–æ—á—É –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —è –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω–∏–º–∞—é, –∑–∞—á–µ–º —Ç—ã –¥–µ–ª–∞–µ—à—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞. –ú—ã –ø—Ä–æ–≤–æ–¥–∏–º –∏–º–ø–æ—Ä—Ç –≤ –Ω–∞—á–∞–ª–µ, –¥–∞–ª–µ–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ç—è–Ω–µ–º –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –≤–Ω–æ—Å—è –≤ –Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è.`
# 
# –î–∞–ª–µ–µ –ø–æ —Ö–æ–¥—É —Ä–∞–±–æ—Ç—ã —Ç—ã —Å–º–æ–∂–µ—à—å –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –æ–Ω–∏ –±—É–¥—É—Ç –æ—Ç–º–µ—á–µ–Ω—ã —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏:
# 
# <div class="alert alert-block alert-success">
# –ü–æ—Ö–≤–∞–ª–∞ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–≤–∏—Ç–∏—è
# </div>
# <div class="alert alert-block alert-warning">
# –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è, –Ω–æ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ
# </div>
# <div class="alert alert-block alert-danger">
# –ì—Ä—É–±–∞—è –æ—à–∏–±–∫–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
# </div>
# 
# 
# –ó–∞—Ä–∞–Ω–µ–µ –ø—Ä–æ—à—É –Ω–µ —É–¥–∞–ª—è—Ç—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —ç—Ç–æ –≤–∞–∂–Ω–æ. –ï—Å–ª–∏ —É —Ç–µ–±—è –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –æ–±–æ–∑–Ω–∞—á—å –∏—Ö, —è —Å —Ä–∞–¥–æ—Å—Ç—å—é —Ç–µ–±–µ –ø–æ–º–æ–≥—É!)
# 
# –ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç, –º–æ–∂–µ—à—å –æ–±–æ–∑–Ω–∞—á–∏—Ç—å –∏—Ö —Ç–∞–∫:
# <div class="alert alert-block alert-info">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –∑–∞—ë–º—â–∏–∫–æ–≤
# 
# –ó–∞–∫–∞–∑—á–∏–∫ ‚Äî –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –æ—Ç–¥–µ–ª –±–∞–Ω–∫–∞. –ù—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –≤–ª–∏—è–µ—Ç –ª–∏ —Å–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —Ñ–∞–∫—Ç –ø–æ–≥–∞—à–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –±–∞–Ω–∫–∞ ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ –ø–ª–∞—Ç—ë–∂–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.
# 
# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç —É—á—Ç–µ–Ω—ã –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ **–∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∑–∞—ë–º—â–∏–∫–∞ –≤–µ—Ä–Ω—É—Ç—å –∫—Ä–µ–¥–∏—Ç –±–∞–Ω–∫—É.
# 
# –ó–∞–¥–∞—á–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
# 1. –û—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
# - –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞—á–∞–ª–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
# - —Å–¥–µ–ª–∞–µ–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã
# - –ø–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª–∏–π
# 
# 
# 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# - –Ω–∞–π—Ç–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏
# - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
# - —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
# - –≤—ã–¥–µ–ª–∏—Ç—å –ª–µ–º–º—ã
# - –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
# 
# 
# 3. –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
# - –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –Ω–∞–ª–∏—á–∏–µ–º –¥–µ—Ç–µ–π –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?
# - –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ–º–µ–π–Ω—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?
# - –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —É—Ä–æ–≤–Ω–µ–º –¥–æ—Ö–æ–¥–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?
# - –ö–∞–∫ —Ä–∞–∑–Ω—ã–µ —Ü–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç –≤ —Å—Ä–æ–∫?
# 
# 
# 4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
# - –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã
# - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

# ### –®–∞–≥ 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –∏–∑—É—á–∏—Ç–µ –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. 

# In[36]:


import pandas as pd
borrowers = pd.read_csv('/datasets/data.csv')
borrowers.head(10)


# In[37]:


print(borrowers.info())


# ### –í—ã–≤–æ–¥

# –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ —Å –¥–∞–Ω–Ω—ã–º–∏.
# –í—ã—è–≤–ª–µ–Ω–æ 3 —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö:
# - float64 (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
# - int64 (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)
# - object (–æ–±—ä–µ–∫—Ç, —Ç–∏–ø)
# 
# - –ü—Ä–æ–ø—É—Å–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤
# 'days_employed'‚Äî –æ–±—â–∏–π —Ç—Ä—É–¥–æ–≤–æ–π —Å—Ç–∞–∂ –≤ –¥–Ω—è—Ö –∏ 
# 'total_income'‚Äî –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥. 
# –û–±–∞ —Ç–∏–ø–∞ - float64 (–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ).
# - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–µ—Ç—è—Ö, –≤ –¥–Ω—è—Ö —Å—Ç–∞–∂–∞
# - –ø—Ä—ã–≥–∞—é—â–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏
# - –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ "0" –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ 

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ú–æ–ª–æ–¥–µ—Ü, —Ç—ã —Ö–æ—Ä–æ—à–æ –æ—Å–º–æ—Ç—Ä–µ–ª –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ –µ—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `describe()`, —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —É–≤–∏–¥–µ—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ (–∏—Ö –ø—Ä–æ—â–µ –±—É–¥–µ—Ç –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å), –ø–ª—é—Å `unique()` –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
# </div>

# ### –®–∞–≥ 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# ### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤

# In[38]:


print(borrowers.isna().sum())
print(borrowers['days_employed'].isnull().head())
print(borrowers['total_income'].isnull().head())


# ### –í—ã–≤–æ–¥

# –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö :
# - days_employed, dtype: bool (–≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤–º–µ—Å—Ç–æ –Ω—É–ª—è)
# - total_income, dtype: bool (–≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤–º–µ—Å—Ç–æ –Ω—É–ª—è)
# 
# –ü—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ë—É–ª–µ–≤—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ "false".
# –¢–∞–∫ –∫–∞–∫, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∏ –∑–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏, –º–æ–∂–Ω–æ –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –ª–∏–±–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –Ω–æ–ª—å.
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞–∂–µ–º —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –¥–æ—Ö–æ–¥–∞. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–æ –¥–Ω–µ–π –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ - –Ω–µ –±—ã–ª–æ –∏ –¥–æ—Ö–æ–¥–∞.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –°–º–æ—Ç—Ä–∏, —Ç—É—Ç –Ω–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞: —É —Ç–µ–±—è True \ False —ç—Ç–æ –≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å ¬´–æ–∫–∞—É, Python, –µ—Å—Ç—å –ª–∏ –≤ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ –ø—Ä–æ–ø—É—Å–∫ –ø–æ –¥–æ—Ö–æ–¥—É?¬ª –ò –æ–Ω —Ç–µ–±–µ –≤—ã–¥–∞–µ—Ç False ¬´–Ω–µ—Ç, –¥—Ä—É–≥, –Ω–µ—Ç—É¬ª, –ª–∏–±–æ –∂–µ True ¬´–µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫¬ª. –°–∞–º–∏ –∂–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–º–µ–Ω–µ–Ω—ã nan.
# 
# 
# </div>

# ### –ó–∞–º–µ–Ω–∞ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö

# In[39]:



"""
–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê: —ç—Ç–æ –ª–∏—à–Ω–µ–µ
import pandas as pd
borrowers = pd.read_csv('/datasets/data.csv')

"""

# –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –°–ü–û–°–û–ë–û–ú 1, –¶–ò–ö–õ
# —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—á–∫—É —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —Ç–∏–ø—É –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞
group_income = borrowers.groupby('income_type')['total_income'].median()

# –∑–∞–ø–æ–ª–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ –º–µ–¥–∏–∞–Ω–Ω—ã–π –¥–æ—Ö–æ–¥, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ç–∏–ø–µ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
for i in group_income.index:

    borrowers.loc[(borrowers['income_type'] == i) & (borrowers['total_income'].isnull()), 'total_income'] = group_income[i]

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –°–ü–û–°–û–ë 2, transform –¥–ª—è —Å—Ç–∞–∂–∞
#—Å–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –º–µ–¥–∏–∞–Ω–µ —Å—Ç–∞–∂—É
med_days_employed = borrowers.groupby('income_type')['days_employed'].transform('median')

#–∑–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ–¥–∏–∞–Ω–æ–π –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
borrowers['days_employed'] = borrowers['days_employed'].fillna(med_days_employed)

#–ø—Ä–∏–≤–æ–¥–∏–º –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
borrowers['days_employed'] = borrowers['days_employed'].abs()

print(borrowers.info())     
   


# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –ï—Å–ª–∏ —Ç—ã —Ä–µ—à–∏–ª –∑–∞–ø–æ–ª–Ω—è—Ç—å –º–µ–¥–∏–∞–Ω–æ–π, —Ç–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω—É–ª–µ–º –≤—ã—à–µ –Ω–µ –Ω—É–∂–Ω–æ
# 
# </div>

# In[40]:


#borrowers = borrowers.fillna(0) #–∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ fillna(0) –¥–ª—è –∑–∞–º–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–∞ –Ω–æ–ª—å
borrowers['days_employed'] = borrowers['days_employed'].abs() #–ø—Ä–∏–≤–µ–¥–µ–º –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
borrowers['days_employed'] = borrowers['days_employed'].astype('int')
borrowers['total_income'] = borrowers['total_income'].astype('int')
print(borrowers.info())


# In[41]:


borrowers.describe()


# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>
# –£—á—Ç–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–ø–æ—Å–æ–±–∞–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞–∂–∞ –∏ –¥–æ—Ö–æ–¥–∞.
# –ó–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ –∏–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –∑–∞–Ω–æ–≤–æ, —Ç–∞–∫ –∫–∞–∫ –±–µ–∑ –∏–º–ø–æ—Ä—Ç–∞ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É (NameError: name 'borrowers' is not defined)
# 

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# * –Ø –≤—Å–µ –ø–æ–¥–ø—Ä–∞–≤–∏–ª, –∏–∑—É—á–∏
# 
# </div>

# ### –í—ã–≤–æ–¥

# –î–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ "false" –Ω–∞ "0" –º–µ—Ç–æ–¥–æ–º "fillna", —Ç–∞–∫ –∫–∞–∫ —Å—Ç–∞–∂ –∏ –¥–æ—Ö–æ–¥, –∑–∞–µ–º—â–∏–∫–∏ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞–ª–∏, –∫–æ–≥–¥–∞ –∏—Ö –Ω–µ –±—ã–ª–æ. –î–∞–ª–µ–µ, –∫–æ–≥–¥–∞ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö 'days_employed' –∏ 'total_income' –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É,   –∑–∞–º–µ–Ω–∏–º –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º "astype".
# –¢–µ–ø–µ—Ä—å –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ —Å—Ç–∞–∂–µ–º –≤ –¥–Ω—è—Ö –∏ –¥–æ—Ö–æ–¥–æ–º.
# 
# 

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
#     
# –í—Å–µ –∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª–µ–º –Ω–µ –≤—ã–≥–ª—è–¥–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º, –∏–∑—É—á–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –Ω–∏–∂–µ
# 
# </div>

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ö–∞—Å–∞–µ–º–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—É—Ç—å –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–π –ø–æ–¥—Ö–æ–¥ ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É!
# 
# –ê –∏–º–µ–Ω–Ω–æ: –æ—Ç —á–µ–≥–æ —É –Ω–∞—Å –∑–∞–≤–∏—Å–∏—Ç —Å—Ç–∞–∂ \ –¥–æ—Ö–æ–¥? –ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç —Ç–∏–ø–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –≤–µ—Ä–Ω–æ? –ò–ª–∏ –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã.
#     
# –ú–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ —Ç–∏–ø—É –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Å –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ —Å—Ç–∞–∂–∞ \ –¥–æ—Ö–æ–¥–∞, –¥–∞–ª–µ–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, —Å–æ–≥–ª–∞—Å–∏—Å—å, —Ç–∞–∫ –±—ã–ª–æ –±—ã –æ–±—ä–µ–∫—Ç–∏–≤–Ω–µ–µ?)
#     
# –ü—Ä–∏–º–µ—Ä—á–∏–∫:
#     
#     
#     # –°–ü–û–°–û–ë 1, –¶–ò–ö–õ
#     # —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—á–∫—É —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —Ç–∏–ø—É –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞
# 
#     group_income = df.groupby('income_type')['total_income'].median()
# 
# 
#     # –∑–∞–ø–æ–ª–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ –º–µ–¥–∏–∞–Ω–Ω—ã–π –¥–æ—Ö–æ–¥, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ç–∏–ø–µ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
#     for i in group_income.index:
# 
#         df.loc[(data['income_type'] == i) & (df['total_income'].isnull()), 'total_income'] = group_income[i]
#         
#         
#     # –°–ü–û–°–û–ë 2, transform
#     #—Å–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –º–µ–¥–∏–∞–Ω–µ –∑–∞—Ä–ø–ª–∞—Ç—ã
#     med_salary = df.groupby('income_type')['total_income'].transform('median')
# 
#     #–∑–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ–¥–∏–∞–Ω–æ–π –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
#     df['total_income'] = df['total_income'].fillna(med_salary)
#     
# </div>

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ù–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∏ —É –Ω–∞—Å –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —è–≤–Ω–æ –∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Å—è —Å –ø–æ–º–æ—â—å—é `isnull()`, –ø–æ—Ä–æ–π –∏—Ö –∑–∞–±–∏–≤–∞—é—Ç –∑–∞—Ç—ã—á–∫–∞–º–∏ (–Ω—É–ª–∏ \ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è \ 9999 –∏ –ø—Ä–æ—á–µ–µ), –ø–æ–ø—Ä–æ–±—É–π –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–∑–Ω–∞–∫ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –ø–æ–ª–∞, –Ω–µ—Ç –ª–∏ —Ç–∞–º —á–µ–≥–æ-—Ç–æ —Å—Ç—Ä–∞–Ω–Ω–æ–≥–æ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã?
#     
# </div>

# In[42]:


#–ü—Ä–æ–≤–µ—Ä—è—é –ø—Ä–∏–∑–Ω–∞–∫ –≤–æ–∑—Ä–∞—Å—Ç–∞
borrowers['dob_years'].describe()


# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>
# 
# –í –≤–æ–∑—Ä–∞—Å—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ü–æ—Å—á–∏—Ç–∞–µ–º –∏—Ö.

# In[43]:


borrowers[borrowers['dob_years'] == 0]['dob_years'].count()


# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>
# 
# 101 –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ 21525 —Å—Ç—Ä–æ–∫. –í –¥–∞–ª—å–Ω–µ–π—à–µ–º —É–±–µ—Ä–µ–º —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π. –≠—Ç–æ –º–µ–Ω–µ–µ 0,5% –≤—ã–±–æ—Ä–∫–∏, —Å—á–∏—Ç–∞—é, —á—Ç–æ —ç—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –ú–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–º–µ–Ω–∏—Ç—å –≤–æ—Ç —Ç–∞–∫:
#     
# `borrowers['dob_years'] = borrowers.groupby('income_type')['dob_years'].transform(lambda x: x.replace(0, int(x.median())))`
# 
# </div>

# In[44]:


# –ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ —Å –ø–æ–ª–æ–º.
borrowers['gender'].unique()


# In[45]:


borrowers[borrowers['gender'] == 'XNA'].count()


# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>
# –ü–æ–ª - XNA 1 —à—Ç—É–∫–∞. –ù–∞ –∏—Ç–æ–≥–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –î–∞–∞, –Ω–æ —ç—Ç–æ –≤—Å–µ –∂–µ –∞–Ω–æ–º–∞–ª–∏—è –∏ –µ–µ —Å–ª–µ–¥–æ–≤–∞–ª–æ –±—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å:
#     
# 
# 
# </div>

# In[46]:


# –ö–û–î –†–ï–í–¨–Æ–í–ï–†–ê

borrowers['gender'] = borrowers['gender'].replace('XNA', 'F') # –∑–∞–º–µ–Ω—è—é –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –ø–æ–ª


# <div class="alert alert-block alert-warning">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ö–∞—Å–∞–µ–º–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å—Ç–∞–∂–∞, —Ç—ã –∫–æ–Ω–µ—á–Ω–æ –º–æ–∂–µ—à—å –∑–∞–±–∏—Ç—å –µ–≥–æ 0, –∏ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–Ω–∞–ª–∏–∑–µ, –ø–æ—ç—Ç–æ–º—É –∑–∞—á–µ–º –µ–≥–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–æ–æ–±—â–µ? –í —Ü–µ–ª–æ–º –ª–æ–≥–∏–∫–∞ –ø–æ–Ω—è—Ç–Ω–∞, –Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–∞–∑–æ–≤–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞, –ø–ª—é—Å –º–Ω–µ –±—ã —Ö–æ—Ç–µ–ª–æ—Å—å, —á—Ç–æ–±—ã —Ç—ã —Å –Ω–∏–º –ø–æ—Ä–∞–±–æ—Ç–∞–ª –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ, —Ç–∫ —ç—Ç–æ –ø—Ä–æ–∫–∞—á–∏–≤–∞–µ—Ç –Ω–∞–≤—ã–∫–∏:
#     
# * –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø–æ–¥—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —Å—Ç–∞–∂–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, —Ç–æ –∑–∞–º–µ—Ç–∏—à—å, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ç–∞–∂–∞. –ß—Ç–æ –ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞–∂ —Ç–æ–ª—å–∫–æ —É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ + –æ–Ω –∂–µ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º.
#     
# * –¥—É–º–∞—é –º–æ–∂–Ω–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —Å—Ç–∞–∂ –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞ 24, –ø–æ—Ç–æ–º –Ω–∞ 365, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω –ø–æ–ø—Ä–æ—Å—Ç—É –∏–∑–º–µ—Ä—è–ª—Å—è –≤ —á–∞—Å–∞—Ö. –î–ª—è –∞–¥–µ–∫–≤–∞—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –º—ã –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∏–º –Ω–∞ 365. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ —Å—Ç–∞–∂–∞ –≤ –≥–æ–¥–∞—Ö.
#     
# * –ø–æ—Å–ª–µ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø–æ–º–æ–∂–µ—Ç abs
#     
# * –∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ —Ç–∏–ø—É –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Å –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –º–µ–¥–∏–∞–Ω—ã
# </div>

# ### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

# In[47]:


borrowers['education'] = borrowers['education'].str.lower() #–ø—Ä–∏–≤–æ–¥–∏–º –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è –∏–∑–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ 
print(borrowers['education'].value_counts()) 


# ### –í—ã–≤–æ–¥

# –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–µ–º—â–∏–∫–æ–≤ –∏–º–µ—é—Ç —Å—Ä–µ–¥–Ω–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ. –¢–∞–∫–∏—Ö –≤ 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º –∑–∞–µ–º—â–∏–∫–æ–≤ —Å –≤—ã—Å—à–∏–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º. 
# –î—É–±–ª–∏–∫–∞—Ç—ã –≤ –¥–∞–Ω–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ –≤—ã–∑–≤–∞–Ω—ã —Ä–∞–∑–Ω—ã–º —Å—Ç–∏–ª–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∫–µ—Ç –∑–∞–µ–º—â–∏–∫–∞–º–∏.
# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≤ –∞–Ω–∫–µ—Ç–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫–∏–º —Å—Ç–∏–ª–µ–º –∑–∞–ø–æ–ª–Ω—è—Ç—å –∞–Ω–∫–µ—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ –ø–µ—á–∞—Ç–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏.

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# * –ó–∞—á–µ–º —Ç—ã –∑–∞–Ω–æ–≤–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—à—å —Ñ–∞–π–ª? –¢—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤ –Ω–∞—á–∞–ª–µ —Å–¥–µ–ª–∞–ª –∏–º–ø–æ—Ä—Ç, –Ω–∞—á–∞–ª –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞, –≤–æ—Ç –∏ –¥–∞–≤–∞–π —É–∂–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º)
#     
# * –ü–æ—Å–º–æ—Ç—Ä–∏ –∫–æ–ª-–≤–æ –ø–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ duplicated().sum() –∏ —É–¥–∞–ª–∏ –∏—Ö
#     
# </div>

# In[48]:


# –£–¥–∞–ª–∏–º –¥—É–±–ª–∏ –∏ —Å–±—Ä–æ—Å–∏–º –∏–Ω–¥–µ–∫—Å
borrowers = borrowers.drop_duplicates().reset_index(drop=True)

# –ü—Ä–æ–≤–µ—Ä–∏–º —É–¥–∞–ª–∏–ª–∏—Å—å –ª–∏ –¥—É–±–ª–∏
borrowers.duplicated().sum()


# ### –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –û–ø—è—Ç—å –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç?)
#     
# </div>

# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê:</b>
# </div>
# –î–∞, –Ω–æ–≤—ã–π –∏–º–ø—Ä–æ—Ç, –∏–Ω–∞—á–µ –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É. –ü–æ—á–µ–º—É –Ω–µ –∑–Ω–∞—é.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –î—É–º–∞—é, —ç—Ç–æ –º–æ–∂–Ω–æ –≤—ã–ª–µ—á–∏—Ç—å –ø—É—Ç–µ–º: `cell->run all above` –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã—à–µ. –¢.–µ. —Ç—ã –≤—Å—Ç–∞–µ—à—å –Ω–∞ —Ç–µ–∫—É—â—É—é —è—á–µ–π–∫—É –∏ –Ω–∞–∂–∏–º–∞–µ—à—å, —Ç–µ–º —Å–∞–º—ã–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—è –≤–µ—Å—å –∫–æ–¥ –≤—ã—à–µ
# 
# </div>

# In[49]:


from pymystem3 import Mystem 
from collections import Counter 
m = Mystem()

def lemmatize_data(row): 
    
    lemmas = m.lemmatize(row)
    return lemmas
 
borrowers['purpose_lemmas'] = borrowers['purpose'].apply(lemmatize_data)
 
print('–°–ª–æ–≤–∞—Ä—å –ª–µ–º–º —Å—Ç–æ–ª–±—Ü–∞ "purpose": ',Counter(borrowers['purpose_lemmas'].sum()))


# ### –í—ã–≤–æ–¥

# –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞–µ–º—â–∏–∫–æ–≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é (6367) –∏ –∂–∏–ª—å–µ–º (4473) , –¥–∞–ª–µ–µ —Å–ª–µ–¥—É–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—å (4315), –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (4022), —Å–≤–∞–¥—å–±–∞ (2348)

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –î–∞, –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ü–µ–ª–∏
#     
# </div>

# # –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Ü–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞, –≤–æ–∑—Ä–∞—Å—Ç—É –∏ —Å—Ç–∞–∂—É.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –ö–æ–¥ –≤ Jupyter –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ç.–µ. –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—ã—à–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ —Ç—ã –Ω–µ —Å–¥–µ–ª–∞–µ—à—å –ü–ï–†–ï–î –Ω–µ–π –∏–º–ø–æ—Ä—Ç Counter \ Mystem
# 
# </div>

# In[50]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')

#from pymystem3 import Mystem 
#from collections import Counter 
#m = Mystem()

borrowers['days_employed'].value_counts()
borrowers['years_employed'] = ((borrowers['days_employed']) / 365).abs() #–ø—Ä–∏–≤–æ–¥–∏–º –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
borrowers['years_employed'].round().value_counts() # –æ–∫—Ä—É–≥–ª–∏–º –¥–æ –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç —Å—Ç–∞–∂–∞

def credit_purpose_status(credit_purpose):
    if '–æ–±—Ä–∞–∑–æ–≤–∞–Ω' in credit_purpose:
        return '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'
    if '–∞–≤—Ç–æ' in credit_purpose:
        return '–ê–≤—Ç–æ–º–æ–±–∏–ª—å'
    if '—Å–≤–∞–¥—å' in credit_purpose:
        return '–°–≤–∞–¥—å–±–∞'
    if '–∂–∏–ª—å' or '–Ω–µ–¥–≤' in credit_purpose:
        return '–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å'
    return '–û—à–∏–±–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏'
borrowers['credit_purpose_status'] = borrowers['purpose'].apply(credit_purpose_status)   

credit_purpose_set = borrowers.groupby('credit_purpose_status')['debt'].count() 
credit_purpose_set.sort_values()


# ### –í—ã–≤–æ–¥

# –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞—è–≤–æ–∫ –±—ã–ª–æ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
#     
# –•–æ—Ä–æ—à–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ü–µ–ª—è–º –∫—Ä–µ–¥–∏—Ç–∞, –Ω–æ –æ–ø—è—Ç—å –∂–µ —è –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω–∏–º–∞—é, –∑–∞—á–µ–º —Ç—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –¥–µ–ª–∞–µ—à—å –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç
# </div>

# # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º.

# In[51]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')

#from pymystem3 import Mystem 
#from collections import Counter 
#m = Mystem()

print(borrowers['dob_years'].value_counts()) 


# –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏–º –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ç–∞–∫:
# –ö–ª–∏–µ–Ω—Ç—ã –º–ª–∞–¥—à–µ 18 –ª–µ—Ç –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´–¥–µ—Ç–∏¬ª;
# –ö–ª–∏–µ–Ω—Ç—ã –æ—Ç 19 –¥–æ 64 –ª–µ—Ç ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è ¬´–≤–∑—Ä–æ—Å–ª—ã–µ¬ª;
# –ö–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 65 –ª–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä—ã¬ª.

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –°–Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π –∑–∞–º–µ–Ω–∏–º –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ —á—Ç–æ-—Ç–æ –±–æ–ª–µ–µ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–µ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–∏–∞–Ω—É –ø–æ —Å–µ–º–µ–π–Ω–æ–º—É —Å—Ç–∞—Ç—É—Å—É, –∏–ª–∏ –∂–µ –ø—Ä–æ—Å—Ç–æ –º–µ–¥–∏–∞–Ω—É
#     
# </div>
# –ü—Ä–∏–º–µ–Ω—è–µ–º –°–ü–û–°–û–ë 2, transform
#—Å–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –º–µ–¥–∏–∞–Ω–µ —Å–µ–º–µ–π–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
med_dob_years = borrowers.groupby('family_status')['dob_years'].transform('median')

#–∑–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ–¥–∏–∞–Ω–æ–π –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
borrowers['dob_years'] = borrowers['dob_years'].fillna(med_dob_years)
                                                            
# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
# –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ —É –Ω–∞—Å —Ç–∞–º –Ω–æ–ª—å, –∞ `fillna` –∑–∞–º–µ–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ nan, —Ç–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥, –∏–Ω–∞—á–µ –Ω—É–ª–∏ —Ç–∞–∫ –∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è:
# 
# 
# </div>

# In[52]:


# –ö–û–î –†–ï–í–¨–Æ–í–ï–†–ê

borrowers['dob_years'] = borrowers.groupby('income_type')['dob_years'].transform(lambda x: x.replace(0, int(x.median())))


# In[53]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')

#from pymystem3 import Mystem 
#from collections import Counter 
#m = Mystem()

def age_group(age):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω—É—é –≥—Ä—É–ø–ø—É –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –≤–æ–∑—Ä–∞—Å—Ç–∞ age, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∞–≤–∏–ª–∞:
        - '–¥–µ—Ç–∏ + Na' –ø—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–∏ age < 18 –ª–µ—Ç (—Ç–∞–∫ –∫–∞–∫ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è "18" - —Å–æ–≤–º–µ—Å—Ç–∏–º –∏—Ö —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "–¥–µ—Ç–∏")
        - '–≤–∑—Ä–æ—Å–ª—ã–µ' –ø—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–∏–∏ age –±–æ–ª–µ–µ 18 –∏ –º–µ–Ω–µ–µ 64, –≤–∫–ª—é—á–∞—è 64
        - '–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä—ã' –≤–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö
        """

        if age < 18:
                return '–¥–µ—Ç–∏ + Na'
        if age <= 64:
                return '–≤–∑—Ä–æ—Å–ª—ã–µ'
        return '–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä—ã' 

borrowers['age_group'] = borrowers['dob_years'].apply(age_group)
print(borrowers['age_group'].value_counts())


# –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ç–∞–∂—É :
# –î–æ 1 –≥–æ–¥–∞ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´–º–∞–ª—ã–π —Å—Ç–∞–∂¬ª;
# –ö–ª–∏–µ–Ω—Ç—ã –æ—Ç 1 –¥–æ 3 –ª–µ—Ç ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è ¬´—Å—Ä–µ–¥–Ω–∏–π —Å—Ç–∞–∂¬ª;
# –ö–ª–∏–µ–Ω—Ç—ã –±–æ–ª—å—à–µ 3 –ª–µ—Ç - –∫–∞—Ç–µ–≥–æ—Ä–∏—è ¬´–±–æ–ª—å—à–æ–π —Å—Ç–∞–∂¬ª.

# In[54]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')

#from pymystem3 import Mystem 
#from collections import Counter 
#m = Mystem()

borrowers['days_employed'].value_counts()
borrowers['years_employed'] = ((borrowers['days_employed']) / 365).abs() #–ø—Ä–∏–≤–æ–¥–∏–º –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
borrowers['years_employed'].round().value_counts() # –æ–∫—Ä—É–≥–ª–∏–º –¥–æ –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç —Å—Ç–∞–∂–∞

def years_employed_group(years_employed):
        if years_employed < 1:
                return '–º–∞–ª—ã–π —Å—Ç–∞–∂'
        if years_employed <= 3:
                return '—Å—Ä–µ–¥–Ω–∏–π —Å—Ç–∞–∂'
        return '–±–æ–ª—å—à–æ–π —Å—Ç–∞–∂' 

borrowers['years_employed_group'] = borrowers['years_employed'].apply(years_employed_group)
print(borrowers['years_employed_group'].value_counts())


# ### –í—ã–≤–æ–¥

# –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å—Ä–µ–¥–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–µ–º—â–∏–∫–æ–≤ –ª—é–¥–µ–π —Å–æ —Å—Ç–∞–∂–µ–º –±–æ–ª–µ–µ 3 –ª–µ—Ç.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –ö–∞—Å–∞–µ–º–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å—Ç–∞–∂–∞ —Ä–∞–Ω–µ–µ —è –¥–∞–ª —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é, —Å—É–¥—è –ø–æ –≤—Å–µ–º—É –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´–±–æ–ª—å—à–æ–π —Å—Ç–∞–∂¬ª –ø–æ–ø–∞–ª–∏ –∫–ª–∏–µ–Ω—Ç—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω—ã–º —Å—Ç–∞–∂–µ–º (–∏–∑—É—á–∏ —Ä–∞–Ω–Ω—é—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é)
#     
# </div>

# ### –®–∞–≥ 3. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

# # - –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –Ω–∞–ª–∏—á–∏–µ–º –¥–µ—Ç–µ–π –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?

# –î–ª—è —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–µ–º—â–∏–∫–æ–≤ –∏–º–µ—é—â–∏—Ö –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–µ–º—â–∏–∫–æ–≤. –ß–µ–º –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ, —Ç–µ–º –Ω–∞–¥–µ–∂–Ω–µ–π –∑–∞–µ–º—â–∏–∫. –î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ —É–º–Ω–æ–∂–∏–º –Ω–∞ 100 –ø–æ–ª—É—á–µ–Ω–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É.*
# 
# *–ó–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–µ–º—â–∏–∫–æ–≤ –∏–º–µ—é—â–∏—Ö –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –∫ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–µ–º—â–∏–∫–æ–≤ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–µ–º–µ –≤–æ–ø—Ä–æ—Å–∞.
# 

# 
# 
# 

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –î–∞–≤–∞–π –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –µ—â–µ –∞–Ω–æ–º–∞–ª–∏—é 20 –¥–µ—Ç–µ–π? –≠—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä–∞–Ω–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É 5 –∏ 20, —Ç–∞–∫ –±—ã –±—ã–ª–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–µ–º—å–∏ —Å 10 –¥–µ—Ç—å–º–∏
#     
# </div>

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
# –ú–æ–ª–æ–¥–µ—Ü, –æ–±—Ä–∞–±–æ—Ç–∞–ª
# 
# 
# </div>

# In[55]:


# —Å—á–∏—Ç–∞–µ–º –æ—à–∏–±–∫–æ–π 20 ‚Äî –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ 2.
borrowers['children'] = borrowers['children'].replace(20, 2)

# –ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ —Å –¥–µ—Ç—å–º–∏ –ø–æ—Ä—è–¥–æ–∫
borrowers['children'].unique()


# In[56]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')
borrowers['children'] = (borrowers['children']).abs()#–ø—Ä–∏–≤–æ–¥–∏–º –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
children_set = borrowers.groupby('children')['debt'].sum() / borrowers.groupby('children')['debt'].count() * 100 


# –í—ã–≤–æ–¥: –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–µ—Ç–µ–π –∑–∞–µ–º—â–∏–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫—Ä–µ–¥–∏—Ç—ã —Ö—É–∂–µ, —á–µ–º —Ç–µ, —É –∫–æ–≥–æ –Ω–µ—Ç –¥–µ—Ç–µ–π.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –°–æ–≥–ª–∞—Å–µ–Ω, –Ω–æ –∫–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç –µ—â–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å ¬´–±–µ–∑ –¥–µ—Ç–µ–π \ –º–∞–ª–æ–¥–µ—Ç–Ω–∞—è \ –º–Ω–æ–≥–æ–¥–µ—Ç–Ω–∞—è¬ª
#     
# </div>

# # - –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ–º–µ–π–Ω—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?

# In[57]:


family_status_set = borrowers.groupby('family_status')['debt'].sum() / borrowers.groupby('family_status')['debt'].count() * 100
family_status_set


# ### –í—ã–≤–æ–¥

# –õ—É—á—à–µ –≤—Å–µ—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫—Ä–µ–¥–∏—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–≤–¥–æ–≤–µ—Ü / –≤–¥–æ–≤–∞". –•—É–∂–µ –≤—Å–µ—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫—Ä–µ–¥–∏—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ù–µ –∂–µ–Ω–∞—Ç / –Ω–µ –∑–∞–º—É–∂–µ–º".
# 

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —Å—Ç–∞—Ç—É—Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫—Ä–µ–¥–∏—Ç–∞. –õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ—Å—Ç–æ—è—Ç –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ—Å—Ç–æ—è–ª–∏ —Ö—É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫—Ä–µ–¥–∏—Ç—ã, –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç —Å–µ–º–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å, –ø—É—Å—Ç—å –¥–∞–∂–µ –∫–æ–≥–¥–∞-—Ç–æ –≤ –ø—Ä–æ—à–ª–æ–º.
#     
# </div>

# In[58]:


# –ö–û–î –†–ï–í–¨–Æ–í–ï–†–ê

import plotly.express as px

def pivot(data, index):
    
    """
    –Ø —Ä–µ—à–∏–ª –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∏—Ç —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—á–∫—É –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–µ, —Ç—É—Ç –Ω–µ—Ç –Ω–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ, —Å–º–æ—Ç—Ä–∏:
    –Ω–∞ –≤—Ö–æ–¥ –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –∏ –ø—Ä–∏–∑–Ω–∞–∫ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏, –¥–∞–ª–µ–µ —Å—Ç—Ä–æ–∏—Ç —Å–≤–æ–¥–Ω—É—é —Å –ø–æ–¥—Å—á–µ—Ç–æ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (count),
    —á–∏—Å–ª–∞ –∑–∞–µ–º—â–∏–∫–æ–≤ (sum), % –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞ (mean). –¢–∫ –ø—Ä–∏–∑–Ω–∞–∫ debt –±–∏–Ω–∞—Ä–Ω—ã–π, —Ç–æ —Ç–∞–∫–∏–µ –∞–≥–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –Ω–µ–ª—å–∑—è –∫—Å—Ç–∞—Ç–∏.
    
    
    count - –ø–æ–¥—Å—á–∏—Ç–∞–µ—Ç —á–∏—Å—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, —Ç.–µ.  –æ–±—â–µ–µ —á–∏—Å–ª–æ –∫–ª–∏–µ–Ω—Ç–æ–≤
    sum - —Å—É–º–º—É –Ω–æ–ª–∏–∫–æ–≤ –∏ –µ–¥–∏–Ω–∏—á–µ–∫, —Ç.–µ. –ø–æ —Ñ–∞–∫—Ç—É –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ —Å—É–º–º–∞ –µ–¥–∏–Ω–∏—Ü => –∫–æ–ª-–≤–æ –¥–æ–ª–∂–Ω–∏–∫–æ–≤
    mean - —Å—É–º–º–∞ –¥–µ–ª–µ–Ω–Ω–∞ –Ω–∞ –∫–æ–ª-–≤–æ, —Ç.–µ. —Ç–µ –∂–µ –¥–æ–ª–∂–Ω–∏–∫–∏ –¥–µ–ª–µ–Ω–Ω—ã–µ –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ –∫–ª–∏–µ–Ω—Ç–æ–≤
    
    –ö–ª–∞—Å—Å–Ω–æ –∂–µ!)
    
    """
    
    pivot = data.pivot_table(index = index, values = 'debt', aggfunc = ['count', 'sum', 'mean']).reset_index()
    pivot.columns = [index, '–ö–æ–ª-–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤', '–ö–æ–ª-–≤–æ –¥–æ–ª–∂–Ω–∏–∫–æ–≤', '% –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞']
    display(pivot.sort_values('% –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞', ascending = False))
    
    
    
    fig = px.bar(pivot, x = index, y = '% –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞', color = '% –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞', title = '% –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ ' + index)
    fig.show()
    

pivot(borrowers, 'family_status')


# # –ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —É—Ä–æ–≤–Ω–µ–º –¥–æ—Ö–æ–¥–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?

# –†–∞–∑–¥–µ–ª–∏–º –∑–∞–µ–º—â–∏–∫–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–æ—Ö–æ–¥–∞.
# –í–æ–∑—å–º–µ–º –∑–∞ –æ—Å–Ω–æ–≤—É –¥–∞–Ω–Ω—ã–µ –†–æ—Å—Å—Ç–∞—Ç–∞ –∑–∞ 2020 –≥–æ–¥, –≥–¥–µ —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ –≤ –†–§ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 45000 —Ä—É–±–ª–µ–π.

# In[59]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')

def income_status(total_income):
    if total_income <= 22500.0:
            return '–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    if total_income <= 45000.0:
            return '–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    if total_income < 90000.0:
            return '–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    return '–°–≤–µ—Ä—Ö–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'

borrowers['income_status'] = borrowers['total_income'].apply(income_status)
borrowers['income_status']

income_set = borrowers.groupby('income_status')['debt'].sum() / borrowers.groupby('income_status')['debt'].count() *100
income_set


# In[60]:


# –ö–û–î –†–ï–í–¨–Æ–í–ï–†–ê

borrowers['income_status'].value_counts()


# ### –í—ã–≤–æ–¥

# –†–∏—Å–∫ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞ –∫—Ä–µ–¥–∏—Ç–∞ —É –∑–∞–µ–º—â–∏–∫–æ–≤ —Å –Ω–∏–∑–∫–∏–º–∏ –¥–æ—Ö–æ–¥–∞–º–∏ –ø–æ—á—Ç–∏ –≤–¥–≤–æ–µ –≤—ã—à–µ —á–µ–º —É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø.

# <div class="alert alert-block alert-danger">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –¥–æ—Ö–æ–¥—É –ø–æ–ª—É—á–∏–ª–∏—Å—å —Å–ª–∏—à–∫–æ–º –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º–∏, —ç—Ç–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ —Å–∫–∞–∂–µ—Ç—Å—è –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏, –∏–∑—É—á–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –Ω–∏–∂–µ, —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
#     
# </div>

# In[61]:


#import pandas as pd
#borrowers = pd.read_csv('/datasets/data.csv')
borrowers['total_income'].quantile([0.25,0.5,0.75])


# In[62]:




# —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–º —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞ –Ω–∞ 4 –≥—Ä—É–ø–ø—ã, –ø—Ä–∏—Å–≤–æ–∏–º —Å—Ç–∞—Ç—É—Å—ã –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
def income_status(total_income):
    if total_income <= 103053.0:
            return '–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    if total_income <= 1145018.0:
            return '–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    if total_income < 203435.0:
            return '–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'
    return '–°–≤–µ—Ä—Ö–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞'

borrowers['income_status'] = borrowers['total_income'].apply(income_status)

borrowers.head()


# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# –ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–∞–∫–∏–º –ø–æ–¥—Ö–æ–¥–æ–º:
#     
# 1. –í—ã–≤–µ—Å—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å –ø–æ–º–æ—â—å—é describe, —Ç–∞–∫ –±—ã —Å—Ä–∞–∑—É –≤—Å–µ –±—ã–ª–æ –≤–∏–¥–Ω–æ
# 
# 2. –õ–∏–±–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —è—â–∏–∫ —Å —É—Å–∞–º–∏ https://plotly.com/python/box-plots/
#     
# 3. –£ –Ω–∞—Å –∫–≤–∞—Ä—Ç–∏–ª—è–º–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 25%. –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –≤—Å–µ —á—Ç–æ –¥–æ 1 –∫–≤–∞—Ä—Ç–∏–ª—è (25%) ‚Äî –Ω–∏–∑–∫–∏–π –¥–æ—Ö–æ–¥, –º–µ–∂–¥—É 1 –∏ –º–µ–¥–∏–Ω–æ–π(2 –∫–≤–∞—Ä—Ç–∏–ª—å) —Ç–æ–∂–µ –±—É–¥–µ—Ç 25% ‚Äî —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥, –æ—Ç –º–µ–¥–∏–∞–Ω—ã –¥–æ 3 –∫–≤–∞—Ä—Ç–∏–ª—è (25%) ‚Äî –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –∞ –≤—Å–µ —á—Ç–æ –¥–∞–ª—å—à–µ 3 –∫–≤–∞—Ä—Ç–∏–ª—è ‚Äî –≤—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥.
# 
# </div>

# In[64]:


# –ö–û–î –†–ï–í–¨–Æ–í–ï–†–ê

pivot(borrowers, 'income_status')


# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
# –°—Ä–µ–¥–Ω–∏–π –∫–ª–∞—Å—Å —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∏—Å–∫–æ–≤—ã–π
# 
# 
# </div>

# # - –ö–∞–∫ —Ä–∞–∑–Ω—ã–µ —Ü–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç –≤ —Å—Ä–æ–∫?

# In[63]:


#from pymystem3 import Mystem 
#from collections import Counter 
#m = Mystem()

def credit_purpose_status(credit_purpose):
    if '–æ–±—Ä–∞–∑–æ–≤–∞–Ω' in credit_purpose:
        return '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'
    if '–∞–≤—Ç–æ' in credit_purpose:
        return '–ê–≤—Ç–æ–º–æ–±–∏–ª—å'
    if '—Å–≤–∞–¥—å' in credit_purpose:
        return '–°–≤–∞–¥—å–±–∞'
    if '–∂–∏–ª—å' or '–Ω–µ–¥–≤' in credit_purpose:
        return '–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å'
    return '–û—à–∏–±–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏'
borrowers['credit_purpose_status'] = borrowers['purpose'].apply(credit_purpose_status)   

credit_purpose_set = borrowers.groupby('credit_purpose_status')['debt'].sum() / borrowers.groupby('credit_purpose_status')['debt'].count() * 100 
credit_purpose_set


# ### –í—ã–≤–æ–¥

# –í–µ—Ä–æ—è—Ç–Ω–æ—Å—å –ø–æ—è–≤–ª–µ–Ω–∏—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç—É –Ω–∞ "–ê–≤—Ç–æ–º–æ–±–∏–ª—å" –∏ "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ" –≤—ã—à–µ, —á–µ–º –Ω–∞ "–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å" –∏ "–°–≤–∞–¥—å–±—É". 

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
# 
# * –°–æ–≥–ª–∞—Å–µ–Ω, –≤–∏–¥–∏–º, —á—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∏—Å–∫–æ–≤—ã–µ —Ü–µ–ª–∏ —ç—Ç–æ —É –Ω–∞—Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—å, —Ç–æ–≥–¥–∞ –∫–∞–∫ —Å–≤–∞–¥—å–±–∞ –∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –Ω–∞–ø—Ä–æ—Ç–∏–≤, —è–≤–ª—è—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —Ü–µ–ª—è–º–∏
# 
# </div>

# ### –®–∞–≥ 4. –û–±—â–∏–π –≤—ã–≤–æ–¥

# –°–∞–º—ã–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –∑–∞–µ–º—â–∏–∫–∏ - —ç—Ç–æ –≤–∑—Ä–æ—Å–ª—ã–µ –ª—é–¥–∏ —Å–æ —Å—Ç–∞–∂–µ–º —Ä–∞–±–æ—Ç—ã –±–æ–ª–µ–µ 3-—Ö –ª–µ—Ç –∏–º–µ—é—â–∏–µ –¥–æ—Ö–æ–¥—ã —Å—Ä–µ–¥–Ω–∏–µ –∏ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–∏—Ö –Ω–µ –∏–º–µ—é—â–∏–µ –¥–µ—Ç–µ–π. –ù–∞–∏–º–µ–Ω–µ–µ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥ –∫—Ä–µ–¥–∏—Ç–∞ –¥–ª—è –±–∞–Ω–∫–∞ - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é. –£—á–∏—Ç—ã–≤–∞—è —ç—Ç–∏ —Ñ–∞–∫—Ç–æ—Ä—ã –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—É—é –¥–ª—è –±–∞–Ω–∫–∞ —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –∏ —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç.

# <div class="alert alert-block alert-success">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê 2:</b> 
#     
#     
# –ö–∞—Å–∞–µ–º–æ –¥–æ—Ö–æ–¥–∞ –ª—é–¥–∏ –Ω–∞–∏–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã –≤ –≥—Ä—É–ø–ø–µ –Ω–∏–∑–∫–æ–≤–æ–≥–æ –∏ –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–≥–æ (–µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é)
# 
# </div>

# <div class="alert alert-block alert-warning">
# <b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –†–ï–í–¨–Æ–í–ï–†–ê:</b> 
#     
#     
# `–ï–≤–≥–µ–Ω–∏–π, —Ç—ã —Ö–æ—Ä–æ—à–æ –≤—ã–ø–æ–ª–Ω–∏–ª –ø—Ä–æ–µ–∫—Ç, –Ω–æ –¥–∞–≤–∞–π –ø–æ–¥–ø—Ä–∞–≤–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã –±—ã—Ç—å –±–æ–ª–µ–µ –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–º–∏`
# 
# </div>

# ### –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
# 
# –ü–æ—Å—Ç–∞–≤—å—Ç–µ 'x' –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞—Ö. –î–∞–ª–µ–µ –Ω–∞–∂–º–∏—Ç–µ Shift+Enter.

# - [x]  –æ—Ç–∫—Ä—ã—Ç —Ñ–∞–π–ª;
# - [ ]  —Ñ–∞–π–ª –∏–∑—É—á–µ–Ω;
# - [ ]  –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è;
# - [ ]  –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è;
# - [ ]  –µ—Å—Ç—å –ø–æ—è—Å–Ω–µ–Ω–∏–µ, –∫–∞–∫–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã;
# - [ ]  –æ–ø–∏—Å–∞–Ω—ã –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö;
# - [ ]  –æ–±—ä—è—Å–Ω–µ–Ω–æ, –ø–æ –∫–∞–∫–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏;
# - [ ]  –∑–∞–º–µ–Ω–µ–Ω –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π;
# - [ ]  –µ—Å—Ç—å –ø–æ—è—Å–Ω–µ–Ω–∏–µ, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—á–µ–º—É;
# - [ ]  —É–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã;
# - [ ]  –µ—Å—Ç—å –ø–æ—è—Å–Ω–µ–Ω–∏–µ, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤;
# - [ ]  –æ–ø–∏—Å–∞–Ω—ã –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø–æ—è–≤–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö;
# - [ ]  –≤—ã–¥–µ–ª–µ–Ω—ã –ª–µ–º–º—ã –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª—è–º–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞;
# - [ ]  –æ–ø–∏—Å–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–∏;
# - [ ]  –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω—ã;
# - [ ]  –µ—Å—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö;
# - [ ]  –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –Ω–∞–ª–∏—á–∏–µ–º –¥–µ—Ç–µ–π –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?";
# - [ ]  –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ–º–µ–π–Ω—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?";
# - [ ]  –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ï—Å—Ç—å –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —É—Ä–æ–≤–Ω–µ–º –¥–æ—Ö–æ–¥–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∫—Ä–µ–¥–∏—Ç–∞ –≤ —Å—Ä–æ–∫?";
# - [ ]  –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ö–∞–∫ —Ä–∞–∑–Ω—ã–µ —Ü–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞ –≤–ª–∏—è—é—Ç –Ω–∞ –µ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç –≤ —Å—Ä–æ–∫?";
# - [ ]  –≤ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –µ—Å—Ç—å –≤—ã–≤–æ–¥—ã;
# - [ ]  –µ—Å—Ç—å –æ–±—â–∏–π –≤—ã–≤–æ–¥.
